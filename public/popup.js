import{c as f,r as n,s as N,j as e,C as h,m as x,l as g,n as u,o as w,p,t as S,B as c,i as E,v as P,q as D,R as T,T as z}from"./assets/index-C3gGH1Qs.js";import{I as A,g as M,s as G,a as k,T as I,b as R,c as b,d as y,S as F,e as L}from"./assets/tabs-DB-rwdg8.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=f("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=f("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=f("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=f("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),U=()=>{const[t,a]=n.useState(""),[l,r]=n.useState(!1),{toast:o}=N(),d=async i=>{if(i.preventDefault(),!t){o({title:"Error",description:"Please enter your primary domain",variant:"destructive"});return}if(!/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}$/.test(t)){o({title:"Invalid Domain",description:"Please enter a valid domain (e.g. example.com)",variant:"destructive"});return}r(!0);try{const m=M(t);await G(t,m),o({title:"Setup Complete!",description:`PhishGuard will now protect emails from ${m.length} possible domain variations.`}),setTimeout(()=>{window.location.reload()},1500)}catch{o({title:"Setup Failed",description:"There was an error setting up PhishGuard",variant:"destructive"})}finally{r(!1)}};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-gradient-to-b from-blue-50 to-white",children:[e.jsxs(h,{className:"w-full max-w-md shadow-lg",children:[e.jsxs(x,{className:"text-center pb-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(g,{className:"h-12 w-12 text-blue-600"})}),e.jsx(u,{className:"text-2xl font-bold text-blue-800",children:"Welcome to PhishGuard"}),e.jsx(w,{className:"text-gray-600",children:"Protect your inbox from phishing attacks by telling us your primary domain"})]}),e.jsxs("form",{onSubmit:d,children:[e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"domain",className:"block text-sm font-medium text-gray-700 mb-1",children:"What is your organization's primary email domain?"}),e.jsx(A,{id:"domain",placeholder:"example.com",value:t,onChange:i=>a(i.target.value),className:"w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'For example, if your email is john@example.com, enter "example.com"'})]})})}),e.jsx(S,{children:e.jsx(c,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:l,children:l?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Setting up protection..."]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(O,{className:"mr-2 h-5 w-5"}),"Set Up Protection"]})})})]})]}),e.jsx("p",{className:"mt-8 text-sm text-gray-500 max-w-md text-center",children:"PhishGuard will scan your emails for domain spoofing and homograph attacks to keep you safe from phishing attempts."})]})},B=P("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function W({className:t,variant:a,...l}){return e.jsx("div",{className:E(B({variant:a}),t),...l})}const Z=()=>{const[t,a]=n.useState(null),[l,r]=n.useState(!0),[o,d]=n.useState(!1),{toast:i}=N();n.useEffect(()=>{j()},[]);const j=async()=>{try{r(!0);const s=await k();a({primaryDomain:s.primaryDomain,variations:s.variations,setupComplete:s.setupComplete,detectionEnabled:s.detectionEnabled,alertsCount:s.alertsCount,lastUpdated:s.lastUpdated})}catch(s){console.error("Error loading data:",s),i({title:"Error",description:"Failed to load your protection data",variant:"destructive"})}finally{r(!1)}},m=async()=>{if(t!=null&&t.primaryDomain){d(!0);try{setTimeout(()=>{i({title:"Protection Updated",description:"Your domain protection has been refreshed"}),d(!1)},1500)}catch{i({title:"Error",description:"Failed to refresh protection data",variant:"destructive"}),d(!1)}}},C=async()=>{if(t)try{const s=!t.detectionEnabled;await L(s),a({...t,detectionEnabled:s}),i({title:s?"Protection Enabled":"Protection Disabled",description:s?"PhishGuard will now protect your inbox":"PhishGuard protection is now paused"})}catch{i({title:"Error",description:"Failed to update protection status",variant:"destructive"})}};return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})}):t?e.jsxs("div",{className:"p-4 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h1",{className:"text-xl font-bold text-blue-800",children:"PhishGuard"})]}),e.jsx(W,{variant:t.detectionEnabled?"default":"outline",className:t.detectionEnabled?"bg-green-600":"text-gray-500",children:t.detectionEnabled?"Protecting":"Disabled"})]}),e.jsxs(h,{className:"mb-4",children:[e.jsxs(x,{className:"pb-2",children:[e.jsx(u,{className:"text-md font-medium",children:"Domain Protection"}),e.jsx(w,{children:"Protecting emails for your domain"})]}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-blue-800",children:t.primaryDomain}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.variations.length," variations monitored"]})]}),e.jsx(c,{variant:"outline",size:"sm",onClick:m,disabled:o,children:o?e.jsx(v,{className:"h-4 w-4 animate-spin"}):e.jsx(v,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Last updated:"})," ",t.lastUpdated?new Date(t.lastUpdated).toLocaleDateString():"Never"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:C,className:t.detectionEnabled?"text-red-500 hover:text-red-600":"text-green-600 hover:text-green-700",children:t.detectionEnabled?e.jsxs("span",{className:"flex items-center",children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Pause"]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Enable"]})})]})]})]}),e.jsxs(h,{className:"mb-4",children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-md font-medium",children:"Protection Stats"})}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Alerts"}),e.jsx("p",{className:"text-2xl font-bold text-blue-800",children:t.alertsCount})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("p",{className:"text-sm font-medium text-green-700",children:t.detectionEnabled?"Active":"Inactive"})]})]})})]}),e.jsxs(I,{defaultValue:"options",children:[e.jsxs(R,{className:"w-full",children:[e.jsx(b,{value:"options",className:"flex-1",children:"Options"}),e.jsx(b,{value:"help",className:"flex-1",children:"Help"})]}),e.jsx(y,{value:"options",children:e.jsxs(h,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-md font-medium",children:"Protection Settings"})}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{variant:"outline",className:"w-full justify-start",onClick:()=>{typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage&&chrome.runtime.openOptionsPage()},children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Advanced Settings"]}),e.jsxs(c,{variant:"outline",className:"w-full justify-start",onClick:()=>{window.open("https://mail.google.com","_blank")},children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Open Gmail"]})]})})]})}),e.jsx(y,{value:"help",children:e.jsxs(h,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-md font-medium",children:"Help & Information"})}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{children:e.jsx("strong",{children:"About PhishGuard"})}),e.jsx("p",{children:"PhishGuard protects you from domain spoofing, homographs, and typosquatting attacks in your emails."}),e.jsx("p",{className:"mt-2",children:e.jsx("strong",{children:"How it works:"})}),e.jsx("p",{children:"We monitor emails for suspicious domains that look similar to your primary domain."}),e.jsx("p",{className:"mt-2",children:e.jsx("strong",{children:"Need help?"})}),e.jsx("p",{children:'If you find a false positive or need assistance, click "Advanced Settings" for more options.'})]})})]})})]})]}):e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("p",{className:"text-red-500",children:"Error loading data. Please try again."}),e.jsx(c,{variant:"outline",onClick:j,className:"mt-2",children:"Retry"})]})},q=()=>{const[t,a]=n.useState(null);return n.useEffect(()=>{(async()=>{try{const r=await k();a(r.setupComplete)}catch(r){console.error("Error checking setup:",r),a(!1)}})()},[]),t===null?e.jsx("div",{className:"flex items-center justify-center h-64 w-96",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})}):e.jsx("div",{className:"w-96 min-h-96",children:t?e.jsx(Z,{}):e.jsx(U,{})})};D(document.getElementById("root")).render(e.jsxs(T.StrictMode,{children:[e.jsx(q,{}),e.jsx(z,{})]}));
